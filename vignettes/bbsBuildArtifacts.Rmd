---
title: "bbsBuildArtifacts: filtering build reports"
author: "Vincent J. Carey, stvjc at channing.harvard.edu"
date: "`r format(Sys.time(), '%B %d, %Y')`"
vignette: >
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{bbsBuildArtifacts: filtering build reports}
  %\VignetteEncoding{UTF-8}
output:
  BiocStyle::html_document:
    highlight: pygments
    number_sections: yes
    theme: united
    toc: yes
---

# Introduction

We'd like to be able to get a quick overview of status for a
subset of Bioconductor packages.  "Status" is relative to
Bioconductor version, package version, build platform, and
condition of the platform.

We'll gradually assemble all the relevant information.

## Example

We have the artifacts for Bioconductor 3.13 for a small
number of packages.  These are placed in `tempdir()`
via `setup_demo_artifacts()`.

`select_artifacts` takes the path to a collection
of artifacts, and a vector of regular expressions to
isolate a group of packages of interest.

```{r chk1}
suppressPackageStartupMessages({
library(bbsBuildArtifacts)
library(DT)
})
setup_demo_artifacts() # writes to tempdir()
hpath = paste(tempdir(), "tokay2", sep="/")
eg = select_artifacts(hpath, c("IRanges", "S4V*", "a4\\."))
eg
```
We use the fact that the artifact for package `a4` will 
have a period right after the package name to select only
it and no other packages with names starting with the string `a4`.

Various outcomes can be retrieved from an artifact collection:
```{r lkela}
get_process_outcomes(eg, "buildsrc", "EllapsedTime")
get_process_outcomes(eg, "buildbin", "PackageFileSize")
```

A simple way to generate a more comprehensive table for a host is:
```{r domo}
tabulate_bbs_metrics( c("IRanges", "^S4V", "a4"), hpath)
```

To acquire detailed text on errors, warnings and notes, use `get_events`.

```{r lkev}
ev = get_events(eg)
sapply(ev, sapply, length)
```

# A larger example

We have a snapshot of build artifacts from 2021 June 14, to which
`tabulate_bbs_metrics` was applied.

```{r lksnap}
data(sc_614)
datatable(sc_614)
```
